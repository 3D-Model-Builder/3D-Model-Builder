<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Builder</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #controlsContainer {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            width: 300px;
            height: auto;
            resize: both;
            overflow: auto;
        }
        #controlsContainer.minimized {
            width: 50px;
            height: 50px;
            overflow: hidden;
            border-radius: 50%;
            padding: 0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            right: 10px;
            bottom: 10px;
            top: auto;
            left: auto;
        }
        #controlsContainer.minimized #controls {
            display: none;
        }
        #controlsContainer.minimized #restoreButton {
            display: block;
        }
        #controlsContainer #minimizeButton {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #restoreButton {
            display: none;
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #minimizeButton img,
        #controlsContainer #restoreButton img {
            width: 20px;
            height: 20px;
        }
        #controlsContainer #codeOutput {
            margin-top: 20px;
            white-space: pre;
            border: 1px solid #ccc;
            padding: 10px;
            display: none;
            font-family: monospace;
        }
        .control-group {
            margin-bottom: 10px;
        }
        .joystick {
            position: absolute;
            bottom: 50px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            touch-action: none;
        }
        .joystick div {
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
        }
        .joystick.left {
            left: 50px;
        }
        .joystick.right {
            right: 50px;
        }
        .toolbar {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        .toolbar button {
            display: block;
            width: 30px;
            height: 30px;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #toolboxPanel {
            position: absolute;
            top: 50px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        #toolboxPanel button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            padding: 10px;
        }
        #additionalInfo {
            margin-top: 20px;
            font-size: 14px;
            color: #333;
        }
        #additionalInfo ul {
            padding-left: 20px;
        }
        #additionalInfo li {
            margin-bottom: 10px;
        }
        #gridCanvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="gridCanvas"></canvas>
    </div>
    <div id="controlsContainer">
        <button id="minimizeButton" onclick="minimizeControls()">
            <img src="https://img.icons8.com/ios/50/000000/minus.png" alt="Minimize" />
        </button>
        <button id="restoreButton" onclick="restoreControls()">
            <img src="https://img.icons8.com/ios/50/000000/plus.png" alt="Restore" />
        </button>
        <div id="controls">
            <h2>3D Model Builder</h2>
            <div class="control-group">
                <label for="shape">Shape:</label>
                <select id="shape">
                    <option value="cube">Cube</option>
                    <option value="sphere">Sphere</option>
                    <option value="cylinder">Cylinder</option>
                    <option value="cone">Cone</option>
                    <option value="torus">Torus</option>
                </select>
            </div>
            <div class="control-group">
                <label for="color">Color:</label>
                <input type="color" id="color" value="#ff0000">
            </div>
            <div class="control-group">
                <button onclick="addShape()">Add Shape</button>
                <button onclick="removeShape()">Remove Shape</button>
                <button onclick="clearAllShapes()">Clear All Shapes</button>
                <button onclick="generateCode()">Generate C# Code</button>
                <button onclick="toggleCodeVisibility()">Toggle Code Visibility</button>
            </div>
            <div class="control-group">
                <label for="shapeSelect">Select Shape:</label>
                <select id="shapeSelect" onchange="selectShape()">
                    <option value="">-- None --</option>
                </select>
            </div>
            <div class="control-group">
                <label>Move X:</label>
                <input type="range" id="moveX" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Y:</label>
                <input type="range" id="moveY" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Z:</label>
                <input type="range" id="moveZ" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Scale X:</label>
                <input type="range" id="scaleX" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Y:</label>
                <input type="range" id="scaleY" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Z:</label>
                <input type="range" id="scaleZ" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div id="codeOutput"></div>
        </div>
    </div>
    <div class="toolbar">
        <button onclick="useMoveTool()">M</button>
        <button onclick="useRotateTool()">R</button>
        <button onclick="useScaleTool()">S</button>
    </div>
    <div id="toolboxPanel">
        <button onclick="repaintTool()">Repaint Tool</button>
        <button onclick="toggleGrid()">Grid</button>
        <button onclick="toggleSnapping()">Snap</button>
    </div>
    <div id="additionalInfo">
        <h3>Additional Information:</h3>
        <ul>
            <li><strong>Toolbar:</strong> Select the tool you want to use (Move, Rotate, Scale).</li>
            <li><strong>Toolbox Panel:</strong> Access additional tools like Repaint, Grid, and Snap.</li>
            <li><strong>Grid:</strong> Toggle the grid overlay for better alignment.</li>
            <li><strong>Snap:</strong> Enable or disable snapping to grid for precise placement.</li>
        </ul>
    </div>
    <script>
        const container = document.getElementById('container');
        const gridCanvas = document.getElementById('gridCanvas');
        const ctx = gridCanvas.getContext('2d');
        const controlsContainer = document.getElementById('controlsContainer');
        const codeOutput = document.getElementById('codeOutput');
        let shapes = [];
        let selectedShape = null;
        let gridEnabled = false;
        let snapEnabled = false;
        const snapInterval = 0.5;
        
        gridCanvas.width = container.clientWidth;
        gridCanvas.height = container.clientHeight;
        
        function drawGrid() {
            ctx.clearRect(0, 0, gridCanvas.width, gridCanvas.height);
            ctx.strokeStyle = '#ddd';
            ctx.lineWidth = 0.5;
            for (let x = 0; x < gridCanvas.width; x += 50) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, gridCanvas.height);
                ctx.stroke();
            }
            for (let y = 0; y < gridCanvas.height; y += 50) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(gridCanvas.width, y);
                ctx.stroke();
            }
        }

        function toggleGrid() {
            gridEnabled = !gridEnabled;
            gridCanvas.style.display = gridEnabled ? 'block' : 'none';
            if (gridEnabled) drawGrid();
        }

        function toggleSnapping() {
            snapEnabled = !snapEnabled;
        }

        function addShape() {
            const shapeType = document.getElementById('shape').value;
            const color = document.getElementById('color').value;
            const shape = {
                type: shapeType,
                color: color,
                position: { x: 0, y: 0, z: 0 },
                scale: { x: 1, y: 1, z: 1 }
            };
            shapes.push(shape);
            updateShapeList();
        }

        function removeShape() {
            if (selectedShape === null) return;
            shapes.splice(selectedShape, 1);
            selectedShape = null;
            updateShapeList();
        }

        function clearAllShapes() {
            shapes = [];
            selectedShape = null;
            updateShapeList();
        }

        function selectShape() {
            selectedShape = document.getElementById('shapeSelect').selectedIndex - 1;
            updateShapeControls();
        }

        function updateShapeList() {
            const shapeSelect = document.getElementById('shapeSelect');
            shapeSelect.innerHTML = '<option value="">-- None --</option>';
            shapes.forEach((shape, index) => {
                shapeSelect.innerHTML += `<option value="${index}">${shape.type}</option>`;
            });
        }

        function updateShapeControls() {
            if (selectedShape === null) return;
            const shape = shapes[selectedShape];
            document.getElementById('moveX').value = shape.position.x;
            document.getElementById('moveY').value = shape.position.y;
            document.getElementById('moveZ').value = shape.position.z;
            document.getElementById('scaleX').value = shape.scale.x;
            document.getElementById('scaleY').value = shape.scale.y;
            document.getElementById('scaleZ').value = shape.scale.z;
        }

        function moveShape() {
            if (selectedShape === null) return;
            const shape = shapes[selectedShape];
            shape.position.x = parseFloat(document.getElementById('moveX').value);
            shape.position.y = parseFloat(document.getElementById('moveY').value);
            shape.position.z = parseFloat(document.getElementById('moveZ').value);
            applySnapping(shape);
        }

        function scaleShape() {
            if (selectedShape === null) return;
            const shape = shapes[selectedShape];
            shape.scale.x = parseFloat(document.getElementById('scaleX').value);
            shape.scale.y = parseFloat(document.getElementById('scaleY').value);
            shape.scale.z = parseFloat(document.getElementById('scaleZ').value);
        }

        function applySnapping(shape) {
            if (!snapEnabled) return;
            shape.position.x = Math.round(shape.position.x / snapInterval) * snapInterval;
            shape.position.y = Math.round(shape.position.y / snapInterval) * snapInterval;
            shape.position.z = Math.round(shape.position.z / snapInterval) * snapInterval;
            updateShapeControls();
        }

        function generateCode() {
            const code = shapes.map((shape, index) => `
                // Shape ${index + 1}
                GameObject shape${index + 1} = GameObject.CreatePrimitive(PrimitiveType.${shape.type.charAt(0).toUpperCase() + shape.type.slice(1)});
                shape${index + 1}.transform.position = new Vector3(${shape.position.x}f, ${shape.position.y}f, ${shape.position.z}f);
                shape${index + 1}.transform.localScale = new Vector3(${shape.scale.x}f, ${shape.scale.y}f, ${shape.scale.z}f);
                shape${index + 1}.GetComponent<Renderer>().material.color = new Color(${parseInt(shape.color.slice(1, 3), 16) / 255.0}f, ${parseInt(shape.color.slice(3, 5), 16) / 255.0}f, ${parseInt(shape.color.slice(5, 7), 16) / 255.0}f);
            `).join('\n');
            codeOutput.textContent = code;
        }

        function toggleCodeVisibility() {
            codeOutput.style.display = codeOutput.style.display === 'none' ? 'block' : 'none';
        }

        function minimizeControls() {
            controlsContainer.classList.add('minimized');
        }

        function restoreControls() {
            controlsContainer.classList.remove('minimized');
        }

        // Initialize
        drawGrid();
    </script>
</body>
</html>
