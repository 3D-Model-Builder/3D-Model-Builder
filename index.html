<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Builder</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #container {
            width: 100vw;
            height: 100vh;
        }
        #controlsContainer {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            width: 300px;
            height: auto;
            resize: both;
            overflow: auto;
        }
        #controlsContainer.minimized {
            width: 50px;
            height: 50px;
            overflow: hidden;
            border-radius: 50%;
            padding: 0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            right: 10px;
            bottom: 10px;
            top: auto;
            left: auto;
        }
        #controlsContainer.minimized #controls {
            display: none;
        }
        #controlsContainer.minimized #restoreButton {
            display: block;
        }
        #controlsContainer #minimizeButton {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #restoreButton {
            display: none;
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #minimizeButton img,
        #controlsContainer #restoreButton img {
            width: 20px;
            height: 20px;
        }
        #controlsContainer #codeOutput {
            margin-top: 20px;
            white-space: pre;
            border: 1px solid #ccc;
            padding: 10px;
            display: none;
            font-family: monospace;
        }
        .control-group {
            margin-bottom: 10px;
        }
        .joystick {
            position: absolute;
            bottom: 50px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            touch-action: none;
        }
        .joystick div {
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
        }
        .joystick.left {
            left: 50px;
        }
        .joystick.right {
            right: 50px;
        }
        .toolbar {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        .toolbar button {
            display: block;
            width: 30px;
            height: 30px;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #toolboxPanel {
            position: absolute;
            top: 50px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        #toolboxPanel button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            padding: 10px;
        }
        #additionalInfo {
            margin-top: 20px;
            font-size: 14px;
            color: #333;
        }
        #additionalInfo ul {
            padding-left: 20px;
        }
        #additionalInfo li {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="controlsContainer">
        <button id="minimizeButton" onclick="minimizeControls()">
            <img src="https://img.icons8.com/ios/50/000000/minus.png" alt="Minimize" />
        </button>
        <button id="restoreButton" onclick="restoreControls()">
            <img src="https://img.icons8.com/ios/50/000000/plus.png" alt="Restore" />
        </button>
        <div id="controls">
            <h2>3D Model Builder</h2>
            <div class="control-group">
                <label for="shape">Shape:</label>
                <select id="shape">
                    <option value="cube">Cube</option>
                    <option value="sphere">Sphere</option>
                    <option value="cylinder">Cylinder</option>
                    <option value="cone">Cone</option>
                    <option value="torus">Torus</option>
                </select>
            </div>
            <div class="control-group">
                <label for="color">Color:</label>
                <input type="color" id="color" value="#ff0000">
            </div>
            <div class="control-group">
                <button onclick="addShape()">Add Shape</button>
                <button onclick="removeShape()">Remove Shape</button>
                <button onclick="clearAllShapes()">Clear All Shapes</button>
                <button onclick="generateCode()">Generate C# Code</button>
                <button onclick="toggleCodeVisibility()">Toggle Code Visibility</button>
            </div>
            <div class="control-group">
                <label for="shapeSelect">Select Shape:</label>
                <select id="shapeSelect" onchange="selectShape()">
                    <option value="">-- None --</option>
                </select>
            </div>
            <div class="control-group">
                <label>Move X:</label>
                <input type="range" id="moveX" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Y:</label>
                <input type="range" id="moveY" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Z:</label>
                <input type="range" id="moveZ" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Scale X:</label>
                <input type="range" id="scaleX" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Y:</label>
                <input type="range" id="scaleY" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Z:</label>
                <input type="range" id="scaleZ" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div id="codeOutput"></div>
        </div>
    </div>
    <div class="toolbar">
        <button onclick="useMoveTool()">M</button>
        <button onclick="useRotateTool()">R</button>
        <button onclick="useScaleTool()">S</button>
    </div>
    <div id="toolboxPanel">
        <button onclick="repaintTool()">Repaint Tool</button>
        <button onclick="toggleGrid()">Grid</button>
        <button onclick="toggleSnapGrid()">Snap Grid</button>
        <button onclick="toggleLight()">Light</button>
    </div>
    <div id="additionalInfo">
        <h3>Additional Information:</h3>
        <ul>
            <li>Use the joystick on the left to rotate the view.</li>
            <li>Use the joystick on the right to move the view.</li>
            <li>Press 'W', 'S', 'A', 'D' to move the camera.</li>
            <li>Use arrow keys to rotate the camera view.</li>
        </ul>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/controls/OrbitControls.js"></script>
    <script>
        // Global Variables
        let camera, scene, renderer, controls;
        let selectedShape = null;
        const shapes = [];
        const shapeSelect = document.getElementById('shapeSelect');
        const moveX = document.getElementById('moveX');
        const moveY = document.getElementById('moveY');
        const moveZ = document.getElementById('moveZ');
        const scaleX = document.getElementById('scaleX');
        const scaleY = document.getElementById('scaleY');
        const scaleZ = document.getElementById('scaleZ');
        const codeOutput = document.getElementById('codeOutput');
        const container = document.getElementById('container');
        let isCodeVisible = false;

        init();
        animate();

        function init() {
            // Scene setup
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);

            // Lighting
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0xffffff, 1, 100);
            pointLight.position.set(10, 10, 10);
            scene.add(pointLight);

            // Controls
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.enableZoom = true;
            controls.enablePan = true;

            // Add Event Listeners for Keyboard Controls
            document.addEventListener('keydown', onKeyDown, false);
            document.addEventListener('keyup', onKeyUp, false);
            window.addEventListener('resize', onWindowResize, false);

            // Joystick Controls
            initJoysticks();
        }

        function initJoysticks() {
            const joystickLeft = document.createElement('div');
            joystickLeft.className = 'joystick left';
            joystickLeft.innerHTML = '<div></div>';
            document.body.appendChild(joystickLeft);

            const joystickRight = document.createElement('div');
            joystickRight.className = 'joystick right';
            joystickRight.innerHTML = '<div></div>';
            document.body.appendChild(joystickRight);

            joystickLeft.addEventListener('touchstart', onJoystickStart);
            joystickLeft.addEventListener('touchmove', onJoystickMove);
            joystickLeft.addEventListener('touchend', onJoystickEnd);

            joystickRight.addEventListener('touchstart', onJoystickStart);
            joystickRight.addEventListener('touchmove', onJoystickMove);
            joystickRight.addEventListener('touchend', onJoystickEnd);
        }

        function onJoystickStart(event) {
            event.preventDefault();
            const touch = event.touches[0];
            const joystick = event.currentTarget;
            joystick.startX = touch.clientX;
            joystick.startY = touch.clientY;
        }

        function onJoystickMove(event) {
            event.preventDefault();
            const touch = event.touches[0];
            const joystick = event.currentTarget;
            const deltaX = touch.clientX - joystick.startX;
            const deltaY = touch.clientY - joystick.startY;
            controls.rotation.x -= deltaY * 0.01;
            controls.rotation.y -= deltaX * 0.01;
        }

        function onJoystickEnd(event) {
            event.preventDefault();
        }

        function onKeyDown(event) {
            switch (event.code) {
                case 'KeyW':
                    controls.moveForward(0.1);
                    break;
                case 'KeyS':
                    controls.moveForward(-0.1);
                    break;
                case 'KeyA':
                    controls.moveRight(-0.1);
                    break;
                case 'KeyD':
                    controls.moveRight(0.1);
                    break;
                case 'ArrowUp':
                    controls.rotateX(0.02);
                    break;
                case 'ArrowDown':
                    controls.rotateX(-0.02);
                    break;
                case 'ArrowLeft':
                    controls.rotateY(0.02);
                    break;
                case 'ArrowRight':
                    controls.rotateY(-0.02);
                    break;
            }
        }

        function onKeyUp(event) {
            // Handle key release if necessary
        }

        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        function addShape() {
            const shapeType = document.getElementById('shape').value;
            const color = document.getElementById('color').value;
            let geometry;

            switch (shapeType) {
                case 'cube':
                    geometry = new THREE.BoxGeometry();
                    break;
                case 'sphere':
                    geometry = new THREE.SphereGeometry();
                    break;
                case 'cylinder':
                    geometry = new THREE.CylinderGeometry();
                    break;
                case 'cone':
                    geometry = new THREE.ConeGeometry();
                    break;
                case 'torus':
                    geometry = new THREE.TorusGeometry();
                    break;
            }

            const material = new THREE.MeshStandardMaterial({ color });
            const shape = new THREE.Mesh(geometry, material);
            scene.add(shape);
            shapes.push(shape);

            const option = document.createElement('option');
            option.value = shape.id;
            option.textContent = `Shape ${shapes.length}`;
            shapeSelect.appendChild(option);
        }

        function removeShape() {
            if (selectedShape) {
                scene.remove(selectedShape);
                shapes.splice(shapes.indexOf(selectedShape), 1);
                shapeSelect.removeChild(shapeSelect.querySelector(`option[value="${selectedShape.id}"]`));
                selectedShape = null;
            }
        }

        function clearAllShapes() {
            shapes.forEach(shape => scene.remove(shape));
            shapes.length = 0;
            shapeSelect.innerHTML = '<option value="">-- None --</option>';
            selectedShape = null;
        }

        function selectShape() {
            const shapeId = shapeSelect.value;
            selectedShape = shapes.find(shape => shape.id === shapeId);
            if (selectedShape) {
                moveX.value = selectedShape.position.x;
                moveY.value = selectedShape.position.y;
                moveZ.value = selectedShape.position.z;
                scaleX.value = selectedShape.scale.x;
                scaleY.value = selectedShape.scale.y;
                scaleZ.value = selectedShape.scale.z;
            }
        }

        function moveShape() {
            if (selectedShape) {
                selectedShape.position.set(
                    parseFloat(moveX.value),
                    parseFloat(moveY.value),
                    parseFloat(moveZ.value)
                );
            }
        }

        function scaleShape() {
            if (selectedShape) {
                selectedShape.scale.set(
                    parseFloat(scaleX.value),
                    parseFloat(scaleY.value),
                    parseFloat(scaleZ.value)
                );
            }
        }

        function generateCode() {
            const code = shapes.map(shape => {
                const type = shape.geometry.type;
                const color = shape.material.color.getHexString();
                const position = shape.position;
                const scale = shape.scale;
                return `
// Shape: ${type}
const geometry = new THREE.${type}();
const material = new THREE.MeshStandardMaterial({ color: 0x${color} });
const shape = new THREE.Mesh(geometry, material);
shape.position.set(${position.x}, ${position.y}, ${position.z});
shape.scale.set(${scale.x}, ${scale.y}, ${scale.z});
scene.add(shape);
`;
            }).join('\n');
            codeOutput.textContent = code;
            codeOutput.style.display = isCodeVisible ? 'block' : 'none';
        }

        function toggleCodeVisibility() {
            isCodeVisible = !isCodeVisible;
            codeOutput.style.display = isCodeVisible ? 'block' : 'none';
        }

        function repaintTool() {
            console.log('Repaint Tool activated');
        }

        function toggleGrid() {
            console.log('Grid toggled');
        }

        function toggleSnapGrid() {
            console.log('Snap Grid toggled');
        }

        function toggleLight() {
            console.log('Light toggled');
        }

        function useMoveTool() {
            console.log('Move Tool activated');
        }

        function useRotateTool() {
            console.log('Rotate Tool activated');
        }

        function useScaleTool() {
            console.log('Scale Tool activated');
        }

        function minimizeControls() {
            document.getElementById('controlsContainer').classList.add('minimized');
        }

        function restoreControls() {
            document.getElementById('controlsContainer').classList.remove('minimized');
        }

        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }
    </script>
</body>
</html>
