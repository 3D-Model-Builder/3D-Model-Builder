<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Model Builder</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
        #container {
            width: 100vw;
            height: 100vh;
        }
        #controlsContainer {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            transition: all 0.3s ease;
            width: 300px;
            height: auto;
            resize: both;
            overflow: auto;
        }
        #controlsContainer.minimized {
            width: 50px;
            height: 50px;
            overflow: hidden;
            border-radius: 50%;
            padding: 0;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            right: 10px;
            bottom: 10px;
            top: auto;
            left: auto;
        }
        #controlsContainer.minimized #controls {
            display: none;
        }
        #controlsContainer.minimized #restoreButton {
            display: block;
        }
        #controlsContainer #minimizeButton {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #restoreButton {
            display: none;
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #f0f0f0;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #controlsContainer #minimizeButton img,
        #controlsContainer #restoreButton img {
            width: 20px;
            height: 20px;
        }
        #controlsContainer #codeOutput {
            margin-top: 20px;
            white-space: pre;
            border: 1px solid #ccc;
            padding: 10px;
            display: none;
            font-family: monospace;
        }
        .control-group {
            margin-bottom: 10px;
        }
        .joystick {
            position: absolute;
            bottom: 50px;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            touch-action: none;
        }
        .joystick div {
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
        }
        .joystick.left {
            left: 50px;
        }
        .joystick.right {
            right: 50px;
        }
        .toolbar {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        .toolbar button {
            display: block;
            width: 30px;
            height: 30px;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        #toolboxPanel {
            position: absolute;
            top: 50px;
            right: 10px;
            background: #fff;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }
        #toolboxPanel button {
            display: block;
            width: 100%;
            margin-bottom: 10px;
            background: #f0f0f0;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            padding: 10px;
        }
        #additionalInfo {
            margin-top: 20px;
            font-size: 14px;
            color: #333;
        }
        #additionalInfo ul {
            padding-left: 20px;
        }
        #additionalInfo li {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <div id="controlsContainer">
        <button id="minimizeButton" onclick="minimizeControls()">
            <img src="https://img.icons8.com/ios/50/000000/minus.png" alt="Minimize" />
        </button>
        <button id="restoreButton" onclick="restoreControls()">
            <img src="https://img.icons8.com/ios/50/000000/plus.png" alt="Restore" />
        </button>
        <div id="controls">
            <h2>3D Model Builder</h2>
            <div class="control-group">
                <label for="shape">Shape:</label>
                <select id="shape">
                    <option value="cube">Cube</option>
                    <option value="sphere">Sphere</option>
                    <option value="cylinder">Cylinder</option>
                    <option value="cone">Cone</option>
                    <option value="torus">Torus</option>
                </select>
            </div>
            <div class="control-group">
                <label for="color">Color:</label>
                <input type="color" id="color" value="#ff0000">
            </div>
            <div class="control-group">
                <button onclick="addShape()">Add Shape</button>
                <button onclick="removeShape()">Remove Shape</button>
                <button onclick="clearAllShapes()">Clear All Shapes</button>
                <button onclick="generateCode()">Generate C# Code</button>
                <button onclick="toggleCodeVisibility()">Toggle Code Visibility</button>
            </div>
            <div class="control-group">
                <label for="shapeSelect">Select Shape:</label>
                <select id="shapeSelect" onchange="selectShape()">
                    <option value="">-- None --</option>
                </select>
            </div>
            <div class="control-group">
                <label>Move X:</label>
                <input type="range" id="moveX" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Y:</label>
                <input type="range" id="moveY" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Move Z:</label>
                <input type="range" id="moveZ" min="-5" max="5" step="0.1" value="0" oninput="moveShape()">
            </div>
            <div class="control-group">
                <label>Scale X:</label>
                <input type="range" id="scaleX" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Y:</label>
                <input type="range" id="scaleY" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div class="control-group">
                <label>Scale Z:</label>
                <input type="range" id="scaleZ" min="0.1" max="5" step="0.1" value="1" oninput="scaleShape()">
            </div>
            <div id="codeOutput"></div>
            <div id="additionalInfo">
                <h3>Additional Information</h3>
                <ul>
                    <li>Shapes can be moved along X, Y, and Z axes using the sliders.</li>
                    <li>Scale shapes uniformly along X, Y, and Z axes using the sliders.</li>
                    <li>Select shapes from the dropdown to manipulate individual shapes.</li>
                    <li>Toggle the visibility of the generated code to see or hide the C# code.</li>
                    <li>The toolbox panel provides additional tools and functionalities for advanced modeling.</li>
                </ul>
            </div>
        </div>
    </div>
    <div id="toolboxPanel">
        <button onclick="useMoveTool()">Move Tool</button>
        <button onclick="useRotateTool()">Rotate Tool</button>
        <button onclick="useScaleTool()">Scale Tool</button>
        <button onclick="toggleRepaintTool()">Repaint Tool</button>
        <button onclick="toggleGrid()">Grid</button>
        <button onclick="toggleSnapGrid()">Snap Grid</button>
        <button onclick="toggleHelp()">Help</button>
        <button onclick="resetScene()">Reset Scene</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // Initialize scene, camera, renderer
        let scene = new THREE.Scene();
        let camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        let renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('container').appendChild(renderer.domElement);

        let shapes = [];
        let selectedShape = null;

        function addShape() {
            const shapeType = document.getElementById('shape').value;
            const color = document.getElementById('color').value;

            let geometry;
            if (shapeType === 'cube') geometry = new THREE.BoxGeometry();
            if (shapeType === 'sphere') geometry = new THREE.SphereGeometry();
            if (shapeType === 'cylinder') geometry = new THREE.CylinderGeometry();
            if (shapeType === 'cone') geometry = new THREE.ConeGeometry();
            if (shapeType === 'torus') geometry = new THREE.TorusGeometry();

            const material = new THREE.MeshBasicMaterial({ color });
            const shape = new THREE.Mesh(geometry, material);
            shape.position.set(0, 0, 0);
            shape.scale.set(1, 1, 1);
            scene.add(shape);
            shapes.push(shape);
            updateShapeSelect();
            render();
        }

        function removeShape() {
            if (selectedShape) {
                scene.remove(selectedShape);
                shapes = shapes.filter(shape => shape !== selectedShape);
                selectedShape = null;
                updateShapeSelect();
                render();
            }
        }

        function clearAllShapes() {
            shapes.forEach(shape => scene.remove(shape));
            shapes = [];
            selectedShape = null;
            updateShapeSelect();
            render();
        }

        function generateCode() {
            const code = shapes.map((shape, index) => {
                const pos = shape.position;
                const scale = shape.scale;
                const color = shape.material.color.getHexString();
                const shapeType = shape.geometry.type.toLowerCase();
                return `// Shape ${index}\n` +
                    `GameObject shape${index} = GameObject.CreatePrimitive(PrimitiveType.${shapeType});\n` +
                    `shape${index}.transform.position = new Vector3(${pos.x.toFixed(2)}, ${pos.y.toFixed(2)}, ${pos.z.toFixed(2)});\n` +
                    `shape${index}.transform.localScale = new Vector3(${scale.x.toFixed(2)}, ${scale.y.toFixed(2)}, ${scale.z.toFixed(2)});\n` +
                    `shape${index}.GetComponent<Renderer>().material.color = ColorFromHex("${color}");\n\n`;
            }).join('');
            document.getElementById('codeOutput').textContent = code;
        }

        function toggleCodeVisibility() {
            const codeOutput = document.getElementById('codeOutput');
            codeOutput.style.display = codeOutput.style.display === 'none' ? 'block' : 'none';
        }

        function updateShapeSelect() {
            const shapeSelect = document.getElementById('shapeSelect');
            shapeSelect.innerHTML = '<option value="">-- None --</option>';
            shapes.forEach((shape, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `Shape ${index}`;
                shapeSelect.appendChild(option);
            });
        }

        function selectShape() {
            const index = document.getElementById('shapeSelect').value;
            selectedShape = index === '' ? null : shapes[index];
        }

        function moveShape() {
            if (selectedShape) {
                selectedShape.position.set(
                    parseFloat(document.getElementById('moveX').value),
                    parseFloat(document.getElementById('moveY').value),
                    parseFloat(document.getElementById('moveZ').value)
                );
                render();
            }
        }

        function scaleShape() {
            if (selectedShape) {
                selectedShape.scale.set(
                    parseFloat(document.getElementById('scaleX').value),
                    parseFloat(document.getElementById('scaleY').value),
                    parseFloat(document.getElementById('scaleZ').value)
                );
                render();
            }
        }

        function useMoveTool() {
            // Implement move tool functionality
        }

        function useRotateTool() {
            // Implement rotate tool functionality
        }

        function useScaleTool() {
            // Implement scale tool functionality
        }

        function toggleRepaintTool() {
            // Implement toggle repaint tool
        }

        function toggleGrid() {
            // Implement toggle grid visibility
        }

        function toggleSnapGrid() {
            // Implement toggle snap grid
        }

        function toggleHelp() {
            alert('Help information: \n- Use the Repaint tool to change shapes\' colors.\n- Use the Grid to align shapes.\n- Use Snap Grid to snap shapes to a grid.\n- Click "Reset Scene" to clear all shapes and start fresh.');
        }

        function resetScene() {
            clearAllShapes();
            console.log('Scene reset');
        }

        function render() {
            renderer.render(scene, camera);
        }

        camera.position.z = 5;
        animate();

        function animate() {
            requestAnimationFrame(animate);
            render();
        }

        function minimizeControls() {
            document.getElementById('controlsContainer').classList.add('minimized');
        }

        function restoreControls() {
            document.getElementById('controlsContainer').classList.remove('minimized');
        }

        // Initialize Joystick
        const joystickLeft = document.createElement('div');
        joystickLeft.classList.add('joystick', 'left');
        joystickLeft.innerHTML = '<div></div>';
        document.body.appendChild(joystickLeft);

        const joystickRight = document.createElement('div');
        joystickRight.classList.add('joystick', 'right');
        joystickRight.innerHTML = '<div></div>';
        document.body.appendChild(joystickRight);

        // Additional Event Listeners
        document.querySelectorAll('#toolboxPanel button').forEach(button => {
            button.addEventListener('click', (event) => {
                const action = event.target.textContent;
                switch (action) {
                    case 'Move Tool':
                        useMoveTool();
                        break;
                    case 'Rotate Tool':
                        useRotateTool();
                        break;
                    case 'Scale Tool':
                        useScaleTool();
                        break;
                    case 'Repaint Tool':
                        toggleRepaintTool();
                        break;
                    case 'Grid':
                        toggleGrid();
                        break;
                    case 'Snap Grid':
                        toggleSnapGrid();
                        break;
                    case 'Help':
                        toggleHelp();
                        break;
                    case 'Reset Scene':
                        resetScene();
                        break;
                }
            });
        });

    </script>
</body>
</html>
